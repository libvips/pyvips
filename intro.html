

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; pyvips 3.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/documentation_options.js?v=dd1205ac"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/collapse.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Image" href="vimage.html" />
    <link rel="prev" title="README" href="README.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pyvips
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">README</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadata-and-attributes">Metadata and attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#numpy-and-pil">NumPy and PIL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calling-libvips-operations">Calling libvips operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logging-and-warnings">Logging and warnings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enums">Enums</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overloads">Overloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expansions">Expansions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#convenience-functions">Convenience functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tracking-and-interrupting-computation">Tracking and interrupting computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-sources-and-targets">Custom sources and targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-documentation">Automatic documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#draw-operations">Draw operations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vimage.html"><code class="docutils literal notranslate"><span class="pre">Image</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="base.html">Base definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="error.html"><code class="docutils literal notranslate"><span class="pre">Error</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="enums.html">The libvips enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="vconnection.html"><code class="docutils literal notranslate"><span class="pre">Connection</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="vsource.html"><code class="docutils literal notranslate"><span class="pre">Source</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="vtarget.html"><code class="docutils literal notranslate"><span class="pre">Target</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="vsourcecustom.html"><code class="docutils literal notranslate"><span class="pre">SourceCustom</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="vtargetcustom.html"><code class="docutils literal notranslate"><span class="pre">TargetCustom</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="vinterpolate.html"><code class="docutils literal notranslate"><span class="pre">Interpolate</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="gvalue.html"><code class="docutils literal notranslate"><span class="pre">GValue</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="gobject.html"><code class="docutils literal notranslate"><span class="pre">GObject</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="voperation.html"><code class="docutils literal notranslate"><span class="pre">Operation</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="vobject.html"><code class="docutils literal notranslate"><span class="pre">VipsObject</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyvips</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/libvips/pyvips/blob/master/doc/intro.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h1>
<p>See the main libvips site for an introduction to the underlying library. These
notes introduce the Python binding.</p>
<p><a class="reference external" href="https://libvips.github.io/libvips">https://libvips.github.io/libvips</a></p>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h2>
<p>This example loads a file, boosts the green channel, sharpens the image,
and saves it back to disc again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvips</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_file</span><span class="p">(</span><span class="s1">&#39;some-image.jpg&#39;</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">*=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_list</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                  <span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">write_to_file</span><span class="p">(</span><span class="s1">&#39;x.jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Reading this example line by line, we have:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_file</span><span class="p">(</span><span class="s1">&#39;some-image.jpg&#39;</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="vimage.html#pyvips.Image.new_from_file" title="pyvips.Image.new_from_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.new_from_file()</span></code></a> can load any image file supported by libvips.
When you load an image, only the header is fetched from the file. Pixels will
not be read until you have built a pipeline of operations and connected it
to an output.</p>
<p>When you load, you can hint what type of access you will need.  In this
example, we will be accessing pixels top-to-bottom as we sweep through
the image reading and writing, so <cite>sequential</cite> access mode is best for us.
The default mode is <code class="docutils literal notranslate"><span class="pre">random</span></code> which allows for full random access to image
pixels, but is slower and needs more memory. See <a class="reference internal" href="enums.html#pyvips.enums.Access" title="pyvips.enums.Access"><code class="xref py py-class docutils literal notranslate"><span class="pre">enums.Access</span></code></a>
for details on the various modes available.</p>
<p>You can also load formatted images from memory with
<a class="reference internal" href="vimage.html#pyvips.Image.new_from_buffer" title="pyvips.Image.new_from_buffer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.new_from_buffer()</span></code></a>, create images that wrap C-style memory arrays
held as Python buffers with <a class="reference internal" href="vimage.html#pyvips.Image.new_from_memory" title="pyvips.Image.new_from_memory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.new_from_memory()</span></code></a>, or make images
from constants with <a class="reference internal" href="vimage.html#pyvips.Image.new_from_list" title="pyvips.Image.new_from_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.new_from_list()</span></code></a>. You can also create custom
sources and targets that link image processing pipelines to your own code,
see <a class="reference internal" href="#custom-sources-and-targets">Custom sources and targets</a>.</p>
<p>The next line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">*=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Multiplies the image by an array constant using one array element for each
image band. This line assumes that the input image has three bands and will
double the middle band. For RGB images, that’s doubling green.</p>
<p>There is a full set arithmetic operator <a class="reference internal" href="#overloads">Overloads</a>, so you can compute with
entire images just as you would with single numbers.</p>
<p>Next we have:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_list</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                  <span class="p">],</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">precision</span> <span class="o">=</span> <span class="s1">&#39;integer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="vimage.html#pyvips.Image.new_from_list" title="pyvips.Image.new_from_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">new_from_list()</span></code></a> creates an image from a list of lists. The
scale is the amount to divide the image by after integer convolution.</p>
<p>See the libvips API docs for <code class="docutils literal notranslate"><span class="pre">vips_conv()</span></code> (the operation
invoked by <a class="reference internal" href="vimage.html#pyvips.Image.conv" title="pyvips.Image.conv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.conv()</span></code></a>) for details on the convolution operator. By
default, it computes with a float mask, but <code class="docutils literal notranslate"><span class="pre">integer</span></code> is fine for this case,
and is much faster.</p>
<p>Finally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">write_to_file</span><span class="p">(</span><span class="s1">&#39;x.jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="vimage.html#pyvips.Image.write_to_file" title="pyvips.Image.write_to_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_to_file()</span></code></a> writes an image back to the filesystem. It can
write any format supported by vips: the file type is set from the filename
suffix. You can also write formatted images to memory, or dump
image data to a C-style array in a Python buffer.</p>
</section>
<section id="metadata-and-attributes">
<h2>Metadata and attributes<a class="headerlink" href="#metadata-and-attributes" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">pyvips</span></code> adds a <a class="reference internal" href="vimage.html#pyvips.Image.__getattr__" title="pyvips.Image.__getattr__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getattr__()</span></code></a> handler to <a class="reference internal" href="vimage.html#pyvips.Image" title="pyvips.Image"><code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code></a> and to
the Image metaclass, then uses it to look up unknown names in libvips.</p>
<p>Names are first checked against the set of properties that libvips
keeps for images, see <a class="reference internal" href="vimage.html#pyvips.Image.width" title="pyvips.Image.width"><code class="xref py py-attr docutils literal notranslate"><span class="pre">width</span></code></a> and friends. If the name is not
found there, <code class="docutils literal notranslate"><span class="pre">pyvips</span></code> searches the set of libvips operations, see the next
section.</p>
<p>As well as the core properties, you can read and write the metadata
that libvips keeps for images with <a class="reference internal" href="vimage.html#pyvips.Image.get" title="pyvips.Image.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.get()</span></code></a> and
friends. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_file</span><span class="p">(</span><span class="s1">&#39;some-image.jpg&#39;</span><span class="p">)</span>
<span class="n">ipct_string</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ipct-data&#39;</span><span class="p">)</span>
<span class="n">exif_date_string</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;exif-ifd0-DateTime&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <a class="reference internal" href="vimage.html#pyvips.Image.get_fields" title="pyvips.Image.get_fields"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fields()</span></code></a> to get a list of all the field names you can use with
<a class="reference internal" href="vimage.html#pyvips.Image.get" title="pyvips.Image.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.get()</span></code></a>.</p>
<p>libvips caches and shares images between different parts of your program. This
means that you can’t modify an image unless you are certain that you have
the only reference to it. You can make a private copy of an image with
<code class="docutils literal notranslate"><span class="pre">copy</span></code>, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">xres</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">yres</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">new_image</span></code> is a private clone of <code class="docutils literal notranslate"><span class="pre">image</span></code> with <code class="docutils literal notranslate"><span class="pre">xres</span></code> and <code class="docutils literal notranslate"><span class="pre">yres</span></code>
changed.</p>
<p>Set image metadata with <a class="reference internal" href="vimage.html#pyvips.Image.set" title="pyvips.Image.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.set()</span></code></a>. Use <a class="reference internal" href="vimage.html#pyvips.Image.copy" title="pyvips.Image.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.copy()</span></code></a> to make
a private copy of the image first, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;icc-profile-data&#39;</span><span class="p">,</span> <span class="n">new_profile</span><span class="p">)</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">new_image</span></code> is a clone of <code class="docutils literal notranslate"><span class="pre">image</span></code> with a new ICC profile attached to
it.</p>
</section>
<section id="numpy-and-pil">
<h2>NumPy and PIL<a class="headerlink" href="#numpy-and-pil" title="Link to this heading">¶</a></h2>
<p>You can use <a class="reference internal" href="vimage.html#pyvips.Image.new_from_array" title="pyvips.Image.new_from_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">new_from_array()</span></code></a> to create a pyvips image from a NumPy array
or a PIL image. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvips</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">PIL.Image</span>
<span class="n">pil_image</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_array</span><span class="p">(</span><span class="n">pil_image</span><span class="p">)</span>
</pre></div>
</div>
<p>Going the other direction, a conversion from a pyvips image to a NumPy array can
be obtained with the <a class="reference internal" href="vimage.html#pyvips.Image.numpy" title="pyvips.Image.numpy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numpy()</span></code></a> method of the <a class="reference internal" href="vimage.html#pyvips.Image" title="pyvips.Image"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvips.Image</span></code></a> class
or from the numpy side with <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.asarray()</span></code>.  This is a fast way to load
many image formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvips</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_file</span><span class="p">(</span><span class="s1">&#39;some-image.jpg&#39;</span><span class="p">)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">PIL.Image.fromarray()</span></code> method can be used to convert a pyvips image
to a PIL image via a NumPy array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pyvips</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">PIL.Image</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">black</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">bands</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pil_image</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="calling-libvips-operations">
<h2>Calling libvips operations<a class="headerlink" href="#calling-libvips-operations" title="Link to this heading">¶</a></h2>
<p>Unknown names which are not image properties are looked up as libvips
operations. For example, the libvips operation <code class="docutils literal notranslate"><span class="pre">add</span></code>, which appears in C as
<code class="docutils literal notranslate"><span class="pre">vips_add()</span></code>, appears in Python as <a class="reference internal" href="vimage.html#pyvips.Image.add" title="pyvips.Image.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.add()</span></code></a>.</p>
<p>The operation’s list of required arguments is searched and the first input
image is set to the value of <code class="docutils literal notranslate"><span class="pre">self</span></code>. Operations which do not take an input
image, such as <a class="reference internal" href="vimage.html#pyvips.Image.black" title="pyvips.Image.black"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.black()</span></code></a>, appear as class methods. The
remainder of the arguments you supply in the function call are used to set
the other required input arguments. Any trailing keyword arguments are used
to set options on the underlying libvips operation.</p>
<p>The result is the required output argument if there is only one result,
or a list of values if the operation produces several results. If the
operation has optional output objects, they are returned as a final
Python dictionary.</p>
<p>For example, <a class="reference internal" href="vimage.html#pyvips.Image.min" title="pyvips.Image.min"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.min()</span></code></a>, the vips operation that searches an
image for the minimum value, has a large number of optional arguments. You
can use it to find the minimum value like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_value</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
<p>You can ask it to return the position of the minimum with <cite>:x</cite> and <cite>:y</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_value</span><span class="p">,</span> <span class="n">opts</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_pos</span> <span class="o">=</span> <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">x_pos</span></code> and <code class="docutils literal notranslate"><span class="pre">y_pos</span></code> will have the coordinates of the minimum value.
There’s actually a convenience method for this, <a class="reference internal" href="vimage.html#pyvips.Image.minpos" title="pyvips.Image.minpos"><code class="xref py py-meth docutils literal notranslate"><span class="pre">minpos()</span></code></a>.</p>
<p>You can also ask for the top <em>n</em> minimum, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_value</span><span class="p">,</span> <span class="n">opts</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x_array</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y_array</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_pos</span> <span class="o">=</span> <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;x_array&#39;</span><span class="p">]</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">opts</span><span class="p">[</span><span class="s1">&#39;y_array&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">x_pos</span></code> and <code class="docutils literal notranslate"><span class="pre">y_pos</span></code> will be 10-element arrays.</p>
<p>Because operations are member functions and return the result image, you can
chain them. For example, you can write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">real</span><span class="p">()</span><span class="o">.</span><span class="n">cos</span><span class="p">()</span>
</pre></div>
</div>
<p>to calculate the cosine of the real part of a complex image.  There is
also a full set of arithmetic <a class="reference internal" href="#overloads">Overloads</a>.</p>
<p>libvips types are automatically wrapped. The binding looks at the type
of argument required by the operation and converts the value you supply,
when it can. For example, <a class="reference internal" href="vimage.html#pyvips.Image.linear" title="pyvips.Image.linear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.linear()</span></code></a> takes a
<code class="docutils literal notranslate"><span class="pre">VipsArrayDouble</span></code> as an argument for the set of constants to use for
multiplication. You can supply this value as an integer, a float, or some
kind of compound object and it will be converted for you. You can write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="mf">12.4</span><span class="p">,</span> <span class="mf">13.9</span><span class="p">)</span>
<span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">linear</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>And so on. A set of overloads are defined for <a class="reference internal" href="vimage.html#pyvips.Image.linear" title="pyvips.Image.linear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.linear()</span></code></a>,
see below.</p>
<p>If an operation takes several input images, you can use a constant for all but
one of them and the wrapper will expand the constant to an image for you. For
example, <a class="reference internal" href="vimage.html#pyvips.Image.ifthenelse" title="pyvips.Image.ifthenelse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ifthenelse()</span></code></a> uses a condition image to pick pixels
between a then and an else image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="n">condition_image</span><span class="o">.</span><span class="n">ifthenelse</span><span class="p">(</span><span class="n">then_image</span><span class="p">,</span> <span class="n">else_image</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use a constant instead of either the then or the else parts and it
will be expanded to an image for you. If you use a constant for both then and
else, it will be expanded to match the condition image. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="n">condition_image</span><span class="o">.</span><span class="n">ifthenelse</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Will make an image where true pixels are green and false pixels are red.</p>
<p>This is useful for <a class="reference internal" href="vimage.html#pyvips.Image.bandjoin" title="pyvips.Image.bandjoin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bandjoin()</span></code></a>, the thing to join two or more
images up bandwise. You can write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rgba</span> <span class="o">=</span> <span class="n">rgb</span><span class="o">.</span><span class="n">bandjoin</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
</pre></div>
</div>
<p>to append a constant 255 band to an image, perhaps to add an alpha channel. Of
course you can also write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="n">image1</span><span class="o">.</span><span class="n">bandjoin</span><span class="p">(</span><span class="n">image2</span><span class="p">)</span>
<span class="n">result_image</span> <span class="o">=</span> <span class="n">image1</span><span class="o">.</span><span class="n">bandjoin</span><span class="p">([</span><span class="n">image2</span><span class="p">,</span> <span class="n">image3</span><span class="p">])</span>
<span class="n">result_image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">bandjoin</span><span class="p">([</span><span class="n">image1</span><span class="p">,</span> <span class="n">image2</span><span class="p">,</span> <span class="n">image3</span><span class="p">])</span>
<span class="n">result_image</span> <span class="o">=</span> <span class="n">image1</span><span class="o">.</span><span class="n">bandjoin</span><span class="p">([</span><span class="n">image2</span><span class="p">,</span> <span class="mi">255</span><span class="p">])</span>
</pre></div>
</div>
<p>and so on.</p>
</section>
<section id="logging-and-warnings">
<h2>Logging and warnings<a class="headerlink" href="#logging-and-warnings" title="Link to this heading">¶</a></h2>
<p>The module uses <code class="docutils literal notranslate"><span class="pre">logging</span></code> to log warnings from libvips, and debug messages
from the module itself. Some warnings are important, for example truncated
files, and you might want to see them.</p>
<p>Add these lines somewhere near the start of your program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading">¶</a></h2>
<p>The wrapper spots errors from vips operations and raises the <a class="reference internal" href="error.html#pyvips.error.Error" title="pyvips.error.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">Error</span></code></a>
exception. You can catch it in the usual way.</p>
</section>
<section id="enums">
<h2>Enums<a class="headerlink" href="#enums" title="Link to this heading">¶</a></h2>
<p>The libvips enums, such as <code class="docutils literal notranslate"><span class="pre">VipsBandFormat</span></code>, appear in pyvips as strings
like <code class="docutils literal notranslate"><span class="pre">'uchar'</span></code>. They are documented as a set of classes for convenience, see
<a class="reference internal" href="enums.html#pyvips.enums.Access" title="pyvips.enums.Access"><code class="xref py py-class docutils literal notranslate"><span class="pre">Access</span></code></a>, for example.</p>
</section>
<section id="overloads">
<h2>Overloads<a class="headerlink" href="#overloads" title="Link to this heading">¶</a></h2>
<p>The wrapper defines the usual set of arithmetic, boolean and relational
overloads on image. You can mix images, constants and lists of constants
freely. For example, you can write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="p">((</span><span class="n">image</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">128</span><span class="p">)</span> <span class="o">|</span> <span class="mi">4</span>
</pre></div>
</div>
</section>
<section id="expansions">
<h2>Expansions<a class="headerlink" href="#expansions" title="Link to this heading">¶</a></h2>
<p>Some vips operators take an enum to select an action, for example
<a class="reference internal" href="vimage.html#pyvips.Image.math" title="pyvips.Image.math"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.math()</span></code></a> can be used to calculate sine of every pixel
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">math</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is annoying, so the wrapper expands all these enums into separate members
named after the enum value. So you can also write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">result_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="convenience-functions">
<h2>Convenience functions<a class="headerlink" href="#convenience-functions" title="Link to this heading">¶</a></h2>
<p>The wrapper defines a few extra useful utility functions:
<a class="reference internal" href="vimage.html#pyvips.Image.bandsplit" title="pyvips.Image.bandsplit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bandsplit()</span></code></a>, <a class="reference internal" href="vimage.html#pyvips.Image.maxpos" title="pyvips.Image.maxpos"><code class="xref py py-meth docutils literal notranslate"><span class="pre">maxpos()</span></code></a>, <a class="reference internal" href="vimage.html#pyvips.Image.minpos" title="pyvips.Image.minpos"><code class="xref py py-meth docutils literal notranslate"><span class="pre">minpos()</span></code></a>,
<a class="reference internal" href="vimage.html#pyvips.Image.median" title="pyvips.Image.median"><code class="xref py py-meth docutils literal notranslate"><span class="pre">median()</span></code></a>.</p>
</section>
<section id="tracking-and-interrupting-computation">
<h2>Tracking and interrupting computation<a class="headerlink" href="#tracking-and-interrupting-computation" title="Link to this heading">¶</a></h2>
<p>You can attach progress handlers to images to watch the progress of
computation.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">black</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">set_progress</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">signal_connect</span><span class="p">(</span><span class="s1">&#39;preeval&#39;</span><span class="p">,</span> <span class="n">preeval_handler</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">signal_connect</span><span class="p">(</span><span class="s1">&#39;eval&#39;</span><span class="p">,</span> <span class="n">eval_handler</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">signal_connect</span><span class="p">(</span><span class="s1">&#39;posteval&#39;</span><span class="p">,</span> <span class="n">posteval_handler</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">avg</span><span class="p">()</span>
</pre></div>
</div>
<p>Handlers are given a <cite>progress</cite> object containing a number of useful fields.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">eval_handler</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">progress</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   run = </span><span class="si">{</span><span class="n">progress</span><span class="o">.</span><span class="n">run</span><span class="si">}</span><span class="s1"> (seconds of run time)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   eta = </span><span class="si">{</span><span class="n">progress</span><span class="o">.</span><span class="n">eta</span><span class="si">}</span><span class="s1"> (estimated seconds left)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   tpels = </span><span class="si">{</span><span class="n">progress</span><span class="o">.</span><span class="n">tpels</span><span class="si">}</span><span class="s1"> (total number of pels)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   npels = </span><span class="si">{</span><span class="n">progress</span><span class="o">.</span><span class="n">npels</span><span class="si">}</span><span class="s1"> (number of pels computed so far)&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   percent = </span><span class="si">{</span><span class="n">progress</span><span class="o">.</span><span class="n">percent</span><span class="si">}</span><span class="s1"> (percent complete)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <a class="reference internal" href="vimage.html#pyvips.Image.set_kill" title="pyvips.Image.set_kill"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.set_kill()</span></code></a> on the image to stop computation early.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">eval_handler</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">progress</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">progress</span><span class="o">.</span><span class="n">percent</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="n">image</span><span class="o">.</span><span class="n">set_kill</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="custom-sources-and-targets">
<h2>Custom sources and targets<a class="headerlink" href="#custom-sources-and-targets" title="Link to this heading">¶</a></h2>
<p>You can load and save images to and from <a class="reference internal" href="vsource.html#pyvips.vsource.Source" title="pyvips.vsource.Source"><code class="xref py py-class docutils literal notranslate"><span class="pre">Source</span></code></a> and
<a class="reference internal" href="vtarget.html#pyvips.vtarget.Target" title="pyvips.vtarget.Target"><code class="xref py py-class docutils literal notranslate"><span class="pre">Target</span></code></a>.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Source</span><span class="o">.</span><span class="n">new_from_file</span><span class="p">(</span><span class="s2">&quot;some/file/name&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="s2">&quot;sequential&quot;</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Target</span><span class="o">.</span><span class="n">new_to_file</span><span class="p">(</span><span class="s2">&quot;some/file/name&quot;</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">write_to_target</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Sources and targets can be files, descriptors (eg. pipes) and areas of memory.</p>
<p>You can define <a class="reference internal" href="vsourcecustom.html#pyvips.vsourcecustom.SourceCustom" title="pyvips.vsourcecustom.SourceCustom"><code class="xref py py-class docutils literal notranslate"><span class="pre">SourceCustom</span></code></a> and <a class="reference internal" href="vtargetcustom.html#pyvips.vtargetcustom.TargetCustom" title="pyvips.vtargetcustom.TargetCustom"><code class="xref py py-class docutils literal notranslate"><span class="pre">TargetCustom</span></code></a> too.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_handler</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">input_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">SourceCustom</span><span class="p">()</span>
<span class="n">source</span><span class="o">.</span><span class="n">on_read</span><span class="p">(</span><span class="n">read_handler</span><span class="p">)</span>

<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">write_handler</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">TargetCustom</span><span class="p">()</span>
<span class="n">target</span><span class="o">.</span><span class="n">on_write</span><span class="p">(</span><span class="n">write_handler</span><span class="p">)</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">pyvips</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">new_from_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">access</span><span class="o">=</span><span class="s1">&#39;sequential&#39;</span><span class="p">)</span>
<span class="n">image</span><span class="o">.</span><span class="n">write_to_target</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="s1">&#39;.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also define seek and finish handlers, see the docs.</p>
</section>
<section id="automatic-documentation">
<h2>Automatic documentation<a class="headerlink" href="#automatic-documentation" title="Link to this heading">¶</a></h2>
<p>The bulk of these API docs are generated automatically by
<a class="reference internal" href="voperation.html#pyvips.voperation.Operation.generate_sphinx_all" title="pyvips.voperation.Operation.generate_sphinx_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Operation.generate_sphinx_all()</span></code></a>. It examines libvips and writes a
summary of each operation and the arguments and options that that operation
expects.</p>
<p>Use the C API docs for more detail:</p>
<p><a class="reference external" href="https://libvips.github.io/libvips/API/current">https://libvips.github.io/libvips/API/current</a></p>
</section>
<section id="draw-operations">
<h2>Draw operations<a class="headerlink" href="#draw-operations" title="Link to this heading">¶</a></h2>
<p>Paint operations like <a class="reference internal" href="vimage.html#pyvips.Image.draw_circle" title="pyvips.Image.draw_circle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.draw_circle()</span></code></a> and
<a class="reference internal" href="vimage.html#pyvips.Image.draw_line" title="pyvips.Image.draw_line"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Image.draw_line()</span></code></a> modify their input image. This makes them
hard to use with the rest of libvips: you need to be very careful about
the order in which operations execute or you can get nasty crashes.</p>
<p>The wrapper spots operations of this type and makes a private copy of the
image in memory before calling the operation. This stops crashes, but it does
make it inefficient. If you draw 100 lines on an image, for example, you’ll
copy the image 100 times. The wrapper does make sure that memory is recycled
where possible, so you won’t have 100 copies in memory.</p>
<p>If you want to avoid the copies, you’ll need to call drawing operations
yourself.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="README.html" class="btn btn-neutral float-left" title="README" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vimage.html" class="btn btn-neutral float-right" title="Image" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, John Cupitt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>